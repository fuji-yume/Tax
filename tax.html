<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>給与明細計算ツール</title>
  <style>
    body{font-family:system-ui,-apple-system,Arial;padding:18px;max-width:900px;margin:auto}
    label{display:block;margin-top:12px}
    input,select{padding:6px;margin-top:6px;width:100%;box-sizing:border-box}
    .row{display:flex;gap:12px}
    .col{flex:1}
    .card{padding:12px;border-radius:8px;border:1px solid #ddd;margin-top:12px}
    table{width:100%;border-collapse:collapse}
    th,td{padding:8px;text-align:left;border-bottom:1px solid #eee}
    button{margin-top:12px;padding:10px 14px}
    .muted{color:#666;font-size:13px}
  </style>
</head>
<body>
  <h1>給与明細 計算ツール</h1>

  <div class="card">
    <label>年齢（歳）<input id="age" type="number" value="30" min="15" max="120" /></label>
    <label>月額支給額（円）<input id="monthlyGross" type="number" value="300000" /></label>
  <label>資格手当（毎月、円）<input id="monthlyAllowance" type="number" value="0" /></label>


    <div class="card">
      <div class="muted">固定料率（編集不可）</div>
      <table>
        <tbody>
          <tr><th>健康保険料率</th><td>10.31%（事業主と折半。本人負担は半分）</td></tr>
          <tr><th>介護保険料（40歳以上）</th><td>0.8%（40歳未満は0.0%。事業主と折半）</td></tr>
          <tr><th>厚生年金保険料率</th><td>18.30%（事業主と折半）</td></tr>
          <tr><th>雇用保険（労働者負担）</th><td>0.55%</td></tr>
          <tr><th>基礎控除（年額）</th><td id="basicDeduction_label">480,000 円</td></tr>
        </tbody>
      </table>
    </div>

    <button id="calc">計算する</button>
  </div>

  <div id="result" class="card" style="display:none">
    <h2>給与明細</h2>
    <table>
      <tbody>
        <tr> <!-- タイトル -->
            <td colspan="4">20**年*月 給与明細書</td>
            <td colspan="2">＊＊＊＊様</td>
        </tr>
        <tr>
            <th rowspan="2">支給</th>
            <th>基本給</th>
            <th>資格手当</th>
        </tr>
        <tr>
            <td id="monthlyGross_out"></td>
            <td id="monthlyAllowance_out"></td>
        </tr>
        <tr>
            <th rowspan="4">控除</th>
            <th>健康保険</th>
            <th>厚生年金</th>
            <th>雇用保険</th>
            <th>介護保険</th>
        </tr>
        <tr>
            <td id="monthlyHealthEmployee_out"></td>
            <td id="monthlyPensionEmployee_out"></td>
            <td id="monthlyEmploymentEmployee_out"></td>
            <td id="monthlyNursingEmployee_out"></td>
        </tr>
         <tr>
            <th>所得税</th>
            <th>住民税</th>
        </tr>
        <tr>
            <td id="monthlyIncomeTax_out"></td>
            <td id="residentTax_out"></td>
        </tr>

        <tr style="display:none"><td id="annualGross_out"></td></tr>
        <tr style="display:none"><td id="annualSocial_out"></td></tr>
        <tr style="display:none"><th>年次 課税所得（概算）</th><td id="taxable_out"></td></tr>
        <tr style="display:none"><th>年次 所得税（累進課税）</th><td id="annualIncomeTax_out"></td></tr>
        <tr style="display:none"><th>月次 所得税（概算）</th><td id="monthlyIncomeTax_out"></td></tr>
        <tr style="display:none"><th>月次 社会保険（本人負担 合計）</th><td id="monthlySocial_out"></td></tr>
        <tr><th>差引支給額</th><th id="netMonthly_out"></th></tr>
      </tbody>
    </table>

    <p style="margin-top:12px;font-size:13px;color:#555">注: 簡易推定です。標準報酬・扶養・住民税・年末調整・社会保険の等級や上限は考慮していません。</p>
  </div>

  <script>
    // 固定料率
    const FIX = {
      health: 0.1031,      // 健康保険料率 10.31%
      nursing: 0.008,      // 介護保険率 0.8%（40歳以上）
      pension: 0.1830,     // 厚生年金 18.30%
      employment: 0.0055,  // 雇用保険 0.55%
      basicDeduction: 480000
    };

    // 累進課税の段階税率（段階ごとに課税）
    const progressiveTaxBrackets = [
      {limit:1950000, rate:0.05},
      {limit:3300000, rate:0.10},
      {limit:6950000, rate:0.20},
      {limit:9000000, rate:0.23},
      {limit:18000000, rate:0.33},
      {limit:40000000, rate:0.40},
      {limit:Infinity, rate:0.45}
    ];

    function calcProgressiveTax(income){
      if(income<=0) return 0;
      let prev=0; let tax=0;
      for(const b of progressiveTaxBrackets){
        if(income<=b.limit){ tax += (income-prev)*b.rate; break; }
        tax += (b.limit-prev)*b.rate;
        prev = b.limit;
      }
      return Math.floor(tax);
    }

    function formatYen(n){ return n.toLocaleString('ja-JP') + ' 円'; }

    document.getElementById('calc').addEventListener('click', ()=>{
      const age = Number(document.getElementById('age').value) || 0;
      const monthlyGross = Number(document.getElementById('monthlyGross').value) || 0;
  const monthlyAllowance = Number(document.getElementById('monthlyAllowance').value) || 0;


      // 年収
      const annualGross = (monthlyGross + monthlyAllowance) * 12;

      // 月次 社会保険（本人負担）
      const monthlyHealthEmployee = monthlyGross * FIX.health / 2; // 折半
      const monthlyPensionEmployee = monthlyGross * FIX.pension / 2; // 折半
      const monthlyEmploymentEmployee = monthlyGross * FIX.employment; // 労働者負担
      const monthlyNursingEmployee = (age >= 40) ? (monthlyGross * FIX.nursing / 2) : 0; // 40歳以上のみ、折半

      const monthlySocial = Math.floor(monthlyHealthEmployee + monthlyPensionEmployee + monthlyEmploymentEmployee + monthlyNursingEmployee);
      const annualSocial = monthlySocial * 12;

      // 課税所得（概算）
      const annualTaxable = Math.max(0, Math.floor(annualGross - annualSocial - FIX.basicDeduction));
      const annualIncomeTax = calcProgressiveTax(annualTaxable);
      const monthlyIncomeTax = Math.ceil(annualIncomeTax / 12);


  // 住民税（課税所得の10%）
  const residentTax = Math.floor(annualTaxable * 0.10);
  document.getElementById('residentTax_out').textContent = formatYen(residentTax);

  const netMonthly = Math.floor(monthlyGross + monthlyAllowance - monthlySocial - monthlyIncomeTax);

      document.getElementById('annualGross_out').textContent = formatYen(annualGross);
  document.getElementById('monthlyGross_out').textContent = formatYen(monthlyGross + monthlyAllowance);
  document.getElementById('monthlyAllowance_out').textContent = formatYen(monthlyAllowance);
      document.getElementById('annualSocial_out').textContent = formatYen(annualSocial);
      document.getElementById('taxable_out').textContent = formatYen(annualTaxable);
      document.getElementById('annualIncomeTax_out').textContent = formatYen(annualIncomeTax);
      document.getElementById('monthlyIncomeTax_out').textContent = formatYen(monthlyIncomeTax);

  document.getElementById('monthlyHealthEmployee_out').textContent = formatYen(Math.floor(monthlyHealthEmployee));
  document.getElementById('monthlyPensionEmployee_out').textContent = formatYen(Math.floor(monthlyPensionEmployee));
  document.getElementById('monthlyEmploymentEmployee_out').textContent = formatYen(Math.floor(monthlyEmploymentEmployee));
  document.getElementById('monthlyNursingEmployee_out').textContent = monthlyNursingEmployee > 0 ? formatYen(Math.floor(monthlyNursingEmployee)) : '-';
      document.getElementById('monthlySocial_out').textContent = formatYen(monthlySocial);
      document.getElementById('netMonthly_out').textContent = formatYen(netMonthly);

      document.getElementById('result').style.display = 'block';
    });
  </script>
</body>
</html>
